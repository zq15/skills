---
name: tool-log-viewer
description: "Query and analyze Claude Code tool call logs. View statistics, recent calls, detailed information, filter by tool name, and identify slow operations. Works with logs generated by the tool call hooks."
metadata:
  {
    "openclaw":
      {
        "emoji": "ðŸ“Š",
        "requires": { "bins": ["python3"] }
      }
  }
---

# Tool Log Viewer

This skill delegates log querying and analysis tasks to a specialized subagent that will interpret user requests and execute the appropriate query commands.

## Usage Instructions

**IMPORTANT:** When this skill is invoked, you MUST immediately use the Task tool to delegate the work to a general-purpose subagent.

### Step 1: Understand User Query

The user may ask for various types of log information:
- **Summary statistics** - "Show me tool usage stats"
- **Recent activity** - "What were the last 10 tool calls?"
- **Detailed inspection** - "Show details of the last Bash call"
- **Tool filtering** - "Show all Read tool calls"
- **Performance analysis** - "Find slow operations"

### Step 2: Launch Subagent

Use the Task tool with `subagent_type: "general-purpose"` to handle the query:

```
Task tool parameters:
- subagent_type: "general-purpose"
- description: "Query tool call logs"
- prompt: [See template below]
```

### Prompt Template for Subagent

```
The user wants to query tool call logs. The log analysis script is located at:
~/.claude/projects/-root-ai-skills/my/tool-log-viewer/scripts/query_logs.py

The logs are stored at: ~/.claude/tool_calls.log

User request: <user_query>

Please analyze the request and execute the appropriate command(s):

## Available Commands

1. **Summary Statistics** - View overall statistics for all tool calls:
   ```bash
   python3 scripts/query_logs.py summary
   ```
   Shows: Total calls, calls per tool, average/total execution time per tool

2. **Recent Calls** - View the most recent tool calls:
   ```bash
   python3 scripts/query_logs.py recent [limit]
   ```
   Default limit: 10. Example: `recent 20` for last 20 calls

3. **Detailed Information** - View full details for a specific call:
   ```bash
   python3 scripts/query_logs.py detail [index]
   ```
   - No index or -1: Last call
   - -2: Second to last
   - 0: First call
   Shows: Timestamp, duration, tool name, full input parameters, complete result

4. **Filter by Tool Name** - View all calls for a specific tool:
   ```bash
   python3 scripts/query_logs.py filter <ToolName>
   ```
   Example: `filter Bash`, `filter Read`, `filter Edit`
   Shows: List of matching calls with timestamps and statistics

5. **Find Slow Calls** - Identify slow tool executions:
   ```bash
   python3 scripts/query_logs.py slow [threshold_ms]
   ```
   Default threshold: 1000ms
   Example: `slow 500` for calls slower than 500ms

## Your Task

1. Interpret the user's request to determine which command(s) to run
2. Execute the appropriate command(s) using the Bash tool
3. Present the results clearly to the user
4. If the user's request is ambiguous, run the most relevant command or ask for clarification

## Important Notes

- Always use the full path to the script or cd to the skill directory first
- The script outputs formatted text - present it directly to the user
- For complex queries, you may need to run multiple commands
- If the log file doesn't exist, inform the user that hooks may not be configured

## Common Query Patterns

**"Show me stats"** â†’ Run `summary`
**"Recent calls"** â†’ Run `recent` with appropriate limit
**"Last bash command"** â†’ Run `filter Bash` then `detail` on recent
**"Slow operations"** â†’ Run `slow` with appropriate threshold
**"What did I just do?"** â†’ Run `recent 5`
**"Performance of X tool"** â†’ Run `filter X`
```

### Example Invocations

**Example 1: General statistics request**
```
User: "Show me tool usage statistics"

Your action:
Use Task tool with:
  prompt: "The user wants to query tool call logs... [full template with user request: Show me tool usage statistics]"
```

**Example 2: Performance analysis**
```
User: "Find slow operations over 2 seconds"

Your action:
Use Task tool with:
  prompt: "The user wants to query tool call logs... [full template with user request: Find slow operations over 2 seconds]"
```

**Example 3: Specific tool inspection**
```
User: "Show me all Edit tool calls"

Your action:
Use Task tool with:
  prompt: "The user wants to query tool call logs... [full template with user request: Show me all Edit tool calls]"
```

## Script Commands Reference

### Summary
```bash
scripts/query_logs.py summary
```
Total calls, calls per tool, average/total time

### Recent
```bash
scripts/query_logs.py recent [limit]
```
Last N tool calls (default: 10)

### Detail
```bash
scripts/query_logs.py detail [index]
```
Full info for specific call (-1: last, -2: second to last, 0: first)

### Filter
```bash
scripts/query_logs.py filter <ToolName>
```
All calls for specific tool (e.g., Bash, Read, Edit)

### Slow
```bash
scripts/query_logs.py slow [threshold_ms]
```
Calls slower than threshold (default: 1000ms)

## Log Format

Logs are stored as JSON lines in `~/.claude/tool_calls.log`:

```json
{
  "timestamp": "2026-02-11T10:30:45Z",
  "session_id": "abc123",
  "tool_name": "Bash",
  "tool_use_id": "toolu_01ABC...",
  "duration_ms": 1234.5,
  "working_directory": "/path/to/dir",
  "input": { "command": "ls -la" },
  "result": { "stdout": "...", "exitCode": 0 }
}
```

## Important Notes

- The subagent has full access to Bash tool to run the query script
- The subagent should interpret user requests and map them to appropriate commands
- Results should be presented clearly without unnecessary formatting changes
- If log file doesn't exist, tool call hooks may need to be configured

## Requirements

- Python 3.6+
- Tool call logging hooks configured in `~/.claude/settings.json`
- Log file at `~/.claude/tool_calls.log`
